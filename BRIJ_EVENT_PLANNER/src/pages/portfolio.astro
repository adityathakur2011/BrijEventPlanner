---
import BaseLayout from "../layouts/BaseLayout.astro";

const baseUrl = import.meta.env.BASE_URL;

const portfolioItems = [
	{
		id: 1,
		src: `${baseUrl}assets/images/portfolio-1.svg`,
		alt: "Elegant wedding ceremony with floral arrangements",
		category: "wedding",
		title: "Garden Wedding Ceremony",
	},
	{
		id: 2,
		src: `${baseUrl}assets/images/portfolio-2.svg`,
		alt: "Corporate conference event setup",
		category: "corporate",
		title: "Annual Corporate Conference",
	},
	{
		id: 3,
		src: `${baseUrl}assets/images/portfolio-3.svg`,
		alt: "Colorful birthday party celebration",
		category: "birthday",
		title: "Princess Themed Birthday",
	},
	{
		id: 4,
		src: `${baseUrl}assets/images/portfolio-4.svg`,
		alt: "Outdoor wedding reception with beautiful decorations",
		category: "wedding",
		title: "Outdoor Wedding Reception",
	},
	{
		id: 5,
		src: `${baseUrl}assets/images/portfolio-5.svg`,
		alt: "Professional corporate networking event",
		category: "corporate",
		title: "Corporate Networking Gala",
	},
	{
		id: 6,
		src: `${baseUrl}assets/images/portfolio-6.svg`,
		alt: "Themed birthday party with custom decorations",
		category: "birthday",
		title: "Superhero Birthday Party",
	},
	{
		id: 7,
		src: `${baseUrl}assets/images/wedding-1.svg`,
		alt: "Elegant wedding ceremony with beautiful floral arch",
		category: "wedding",
		title: "Romantic Ballroom Wedding",
	},
	{
		id: 8,
		src: `${baseUrl}assets/images/corporate-1.svg`,
		alt: "Professional corporate conference setup with stage and seating",
		category: "corporate",
		title: "Product Launch Event",
	},
	{
		id: 9,
		src: `${baseUrl}assets/images/birthday-1.svg`,
		alt: "Colorful children's birthday party with themed decorations",
		category: "birthday",
		title: "Fairy Tale Birthday",
	},
	{
		id: 10,
		src: `${baseUrl}assets/images/wedding-2.svg`,
		alt: "Stunning wedding reception table setting",
		category: "wedding",
		title: "Luxury Wedding Reception",
	},
	{
		id: 11,
		src: `${baseUrl}assets/images/corporate-2.svg`,
		alt: "Corporate networking event with elegant table settings",
		category: "corporate",
		title: "Executive Dinner",
	},
	{
		id: 12,
		src: `${baseUrl}assets/images/birthday-2.svg`,
		alt: "Elegant milestone birthday celebration setup",
		category: "birthday",
		title: "Milestone 50th Birthday",
	},
];

const categories = [
	{ id: "all", label: "All" },
	{ id: "wedding", label: "Wedding" },
	{ id: "corporate", label: "Corporate" },
	{ id: "birthday", label: "Birthday" },
];
---

<BaseLayout
	title="Portfolio - Our Event Planning Work & Gallery"
	description="Explore our portfolio of beautifully executed events including weddings, corporate gatherings, and birthday celebrations. See our expertise in action through our gallery of successful events."
	image={`${baseUrl}assets/images/portfolio-1.svg`}
>
	<!-- Hero Section -->
	<section class="relative py-16 lg:py-24 bg-gradient-to-br from-rose-100 to-pink-100 dark:from-slate-800 dark:to-slate-900">
		<div class="container mx-auto px-4 sm:px-6 lg:px-8">
			<div class="text-center max-w-3xl mx-auto">
				<h1 class="text-4xl sm:text-5xl lg:text-6xl font-serif font-bold text-slate-900 dark:text-slate-100 mb-6">
					Our Portfolio
				</h1>
				<p class="text-lg sm:text-xl text-slate-700 dark:text-slate-300 leading-relaxed">
					Explore our gallery of beautifully executed events and celebrations
				</p>
			</div>
		</div>
	</section>

	<!-- Portfolio Section -->
	<section class="py-16 lg:py-24 bg-white dark:bg-slate-900" aria-labelledby="portfolio-heading">
		<div class="container mx-auto px-4 sm:px-6 lg:px-8">
			<!-- Category Filters -->
			<div class="flex flex-wrap justify-center gap-3 mb-12 lg:mb-16" role="tablist" aria-label="Portfolio category filters">
				{categories.map((category) => (
					<button
						type="button"
						class={`portfolio-filter px-6 py-3 rounded-lg font-semibold text-sm sm:text-base transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-rose-400 focus:ring-offset-2 ${
							category.id === "all"
								? "bg-rose-600 text-white hover:bg-rose-700"
								: "bg-rose-50 dark:bg-slate-800 text-slate-700 dark:text-slate-300 hover:bg-rose-100 dark:hover:bg-slate-700"
						}`}
						data-category={category.id}
						role="tab"
						aria-selected={category.id === "all" ? "true" : "false"}
						aria-controls={`portfolio-${category.id}`}
					>
						{category.label}
					</button>
				))}
			</div>

			<!-- Portfolio Grid -->
			<div
				id="portfolio-grid"
				class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6"
				role="tabpanel"
			>
				{portfolioItems.map((item) => (
					<article
						class="portfolio-item group relative overflow-hidden rounded-xl aspect-[4/3] bg-slate-200 dark:bg-slate-700 cursor-pointer"
						data-category={item.category}
						data-item-id={item.id}
						role="img"
						aria-label={item.alt}
					>
						<img
							src={item.src}
							alt={item.alt}
							loading="lazy"
							width="800"
							height="600"
							class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"
							decoding="async"
						/>
						<!-- Overlay -->
						<div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end">
							<div class="p-4 w-full">
								<h3 class="text-white font-semibold text-lg mb-1">{item.title}</h3>
								<p class="text-rose-200 text-sm capitalize">{item.category}</p>
							</div>
						</div>
						<!-- Placeholder overlay for missing images -->
						<div class="absolute inset-0 bg-gradient-to-br from-rose-200 to-pink-300 dark:from-rose-900 dark:to-pink-900 flex items-center justify-center opacity-0 group-hover:opacity-10 transition-opacity duration-300">
							<svg
								class="w-16 h-16 text-white/50"
								fill="none"
								stroke="currentColor"
								viewBox="0 0 24 24"
								xmlns="http://www.w3.org/2000/svg"
								aria-hidden="true"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
								/>
							</svg>
						</div>
					</article>
				))}
			</div>

			<!-- Empty State (hidden by default) -->
			<div id="empty-state" class="hidden text-center py-12">
				<p class="text-lg text-slate-600 dark:text-slate-400">No items found in this category.</p>
			</div>
		</div>
	</section>

	<!-- Lightbox Modal -->
	<div
		id="lightbox"
		class="fixed inset-0 z-50 hidden items-center justify-center bg-black/90 backdrop-blur-sm"
		role="dialog"
		aria-modal="true"
		aria-labelledby="lightbox-title"
	>
		<!-- Close Button -->
		<button
			id="lightbox-close"
			type="button"
			class="absolute top-4 right-4 p-2 text-white hover:text-rose-400 transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-white focus:ring-offset-2 focus:ring-offset-black rounded-lg"
			aria-label="Close lightbox"
		>
			<svg
				class="w-8 h-8"
				fill="none"
				stroke="currentColor"
				viewBox="0 0 24 24"
				xmlns="http://www.w3.org/2000/svg"
				aria-hidden="true"
			>
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
			</svg>
		</button>

		<!-- Previous Button -->
		<button
			id="lightbox-prev"
			type="button"
			class="absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 hover:bg-white/20 text-white rounded-full transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-white focus:ring-offset-2 focus:ring-offset-black"
			aria-label="Previous image"
		>
			<svg
				class="w-6 h-6"
				fill="none"
				stroke="currentColor"
				viewBox="0 0 24 24"
				xmlns="http://www.w3.org/2000/svg"
				aria-hidden="true"
			>
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
			</svg>
		</button>

		<!-- Next Button -->
		<button
			id="lightbox-next"
			type="button"
			class="absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 hover:bg-white/20 text-white rounded-full transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-white focus:ring-offset-2 focus:ring-offset-black"
			aria-label="Next image"
		>
			<svg
				class="w-6 h-6"
				fill="none"
				stroke="currentColor"
				viewBox="0 0 24 24"
				xmlns="http://www.w3.org/2000/svg"
				aria-hidden="true"
			>
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
			</svg>
		</button>

		<!-- Lightbox Content -->
		<div class="max-w-6xl w-full mx-4">
			<img
				id="lightbox-image"
				src=""
				alt=""
				class="max-w-full max-h-[90vh] mx-auto object-contain rounded-lg"
			/>
			<div class="text-center mt-4">
				<h3 id="lightbox-title" class="text-white text-xl font-semibold mb-2"></h3>
				<p id="lightbox-category" class="text-rose-200 text-sm"></p>
			</div>
		</div>
	</div>
</BaseLayout>

<script is:inline>
	// Optimized Portfolio Filtering
	(function() {
		'use strict';
		const f = document.querySelectorAll('.portfolio-filter');
		const i = document.querySelectorAll('.portfolio-item');
		const e = document.getElementById('empty-state');
		const g = document.getElementById('portfolio-grid');

		const filter = (cat) => {
			let count = 0;
			i.forEach((item) => {
				const show = cat === 'all' || item.getAttribute('data-category') === cat;
				item.style.display = show ? 'block' : 'none';
				if (show) count++;
			});

			if (count === 0) {
				e?.classList.remove('hidden');
				g?.classList.add('hidden');
			} else {
				e?.classList.add('hidden');
				g?.classList.remove('hidden');
			}

			f.forEach((btn) => {
				const active = btn.getAttribute('data-category') === cat;
				btn.setAttribute('aria-selected', active.toString());
				btn.className = active
					? 'portfolio-filter px-6 py-3 rounded-lg font-semibold text-sm sm:text-base transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-rose-400 focus:ring-offset-2 bg-rose-600 text-white hover:bg-rose-700'
					: 'portfolio-filter px-6 py-3 rounded-lg font-semibold text-sm sm:text-base transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-rose-400 focus:ring-offset-2 bg-rose-50 dark:bg-slate-800 text-slate-700 dark:text-slate-300 hover:bg-rose-100 dark:hover:bg-slate-700';
			});
		};

		f.forEach((btn) => {
			btn.addEventListener('click', () => filter(btn.getAttribute('data-category')));
		});
	})();

	// Optimized Lightbox Functionality
	(function() {
		'use strict';
		const lb = document.getElementById('lightbox');
		const li = document.getElementById('lightbox-image');
		const lt = document.getElementById('lightbox-title');
		const lc = document.getElementById('lightbox-category');
		const lclose = document.getElementById('lightbox-close');
		const lprev = document.getElementById('lightbox-prev');
		const lnext = document.getElementById('lightbox-next');
		const items = document.querySelectorAll('.portfolio-item');

		let idx = 0;
		let visible = [];

		const update = () => {
			visible = Array.from(items).filter((item) => item.style.display !== 'none');
		};

		const open = (i) => {
			update();
			if (visible.length === 0) return;
			idx = i;
			const item = visible[idx];
			const img = item?.querySelector('img');
			const title = item?.querySelector('h3')?.textContent || '';
			const cat = item?.getAttribute('data-category') || '';

			if (img && li && lt && lc) {
				li.src = img.src;
				li.alt = img.alt;
				lt.textContent = title;
				lc.textContent = cat.charAt(0).toUpperCase() + cat.slice(1);
			}

			if (lb) {
				lb.classList.remove('hidden');
				lb.classList.add('flex');
				document.body.style.overflow = 'hidden';
			}
		};

		const close = () => {
			if (lb) {
				lb.classList.add('hidden');
				lb.classList.remove('flex');
				document.body.style.overflow = '';
			}
		};

		const next = () => {
			update();
			if (visible.length === 0) return;
			idx = (idx + 1) % visible.length;
			open(idx);
		};

		const prev = () => {
			update();
			if (visible.length === 0) return;
			idx = (idx - 1 + visible.length) % visible.length;
			open(idx);
		};

		items.forEach((item) => {
			item.addEventListener('click', () => {
				update();
				const i = visible.indexOf(item);
				if (i !== -1) open(i);
			});
		});

		if (lclose) lclose.addEventListener('click', close);
		if (lnext) lnext.addEventListener('click', next);
		if (lprev) lprev.addEventListener('click', prev);

		if (lb) {
			lb.addEventListener('click', (e) => {
				if (e.target === lb) close();
			});
		}

		document.addEventListener('keydown', (e) => {
			if (lb && !lb.classList.contains('hidden')) {
				if (e.key === 'Escape') close();
				else if (e.key === 'ArrowRight') next();
				else if (e.key === 'ArrowLeft') prev();
			}
		});
	})();
</script>

<style>
	/* Portfolio grid animations */
	.portfolio-item {
		animation: fadeIn 0.3s ease-in;
	}

	@keyframes fadeIn {
		from {
			opacity: 0;
			transform: scale(0.95);
		}
		to {
			opacity: 1;
			transform: scale(1);
		}
	}

	/* Lightbox animations */
	#lightbox {
		animation: fadeIn 0.3s ease-in;
	}

	#lightbox img {
		animation: zoomIn 0.3s ease-in;
	}

	@keyframes zoomIn {
		from {
			opacity: 0;
			transform: scale(0.9);
		}
		to {
			opacity: 1;
			transform: scale(1);
		}
	}

	/* Ensure images don't break layout */
	img {
		max-width: 100%;
		height: auto;
	}

	/* Focus styles for better accessibility */
	*:focus-visible {
		outline: 2px solid rgb(251, 113, 133);
		outline-offset: 2px;
	}
</style>

